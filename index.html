<!doctype html>
<head>
	<title>Calculator</title>
	<style>
		body
		{
			background-color : black;
		}
		body
		{
			display : flex;
			align-content : center;
			justify-content : center;
		}
		#body
		{
			height : 95vh;
			width : 80vw;
			background-color : white;
		}
		#disp
		{
			border-radius : 5px;
			margin : 20px;
			border : 1px solid black;
			background-color : lightblue;
			width : 70vw;
			height : 10vh;
			font-size : 2rem;
			align-content:right;
		}
		button
		{
			margin : 20px;
			font-size : 1.5rem;
			width : 16vw;
			height : 10vh;
		}
		label
		{
			font-size: 1.5rem;
		}
	</style>
</head>
<body>
	<div id="body">
	<center>
		<h1>Binary Calculator (with optional Decimal Output Display)</h1>
		<div id="disp"></div>
		<div id="inp">
			<label>
				<input type="radio" name="n" value="binary" checked> Display in Binary Only
			</label>
			<label>
				<input type="radio" name="n" value="both"> Display in Binary and Decimal
			</label>
		</div>

		<div id="bt1">
			<button onclick="getstr(this)">0</button>
			<button onclick="getstr(this)">1</button>
			<button onclick="getstr(this)">=</button>
			<button onclick="bksp()">Backspace</button>
		</div>
		<div id="bt2">
			<button class="i" onclick="getstr(this)">Logical AND</button>
			<button class="i" onclick="getstr(this)">Logical OR</button>
			<button class="i" onclick="getstr(this)">Logical NOT</button>
			<button onclick="rest()">RESET</button>
		</div>
		<div id="bt3">
			<button class="i" onclick="getstr(this)">Bitwise Right Shift</button>
			<button class="i" onclick="getstr(this)">Bitwise Left Shift</button>
			<button class="i" onclick="getstr(this)">Bitwise NOT</button>
			<button onclick="prev()">Previous</button>
		</div>
		<div id="bt4">
			<button class="i" onclick="getstr(this)">Bitwise AND</button>
			<button class="i" onclick="getstr(this)">Bitwise OR</button>
			<button class="i" onclick="getstr(this)">Bitwise XOR</button>
			<button onclick="next()">Next</button>
		</div>
	</center>
	</div>
	<script>
		var str=""; var save=[]; var che=1; var arr=[];
		function vis()
		{
			if(document.querySelectorAll(".i")[0].style.visibility== "hidden")
				document.querySelectorAll(".i").forEach(e=>e.style.visibility = "visible");
		}
		function bksp()
		{
			if(str.length>0)
			{
				str=str.slice(0, str.length-1);
				document.getElementById("disp").innerText = str;
				vis();
			}
			else
				document.getElementById("disp").innerText = "No Input Yet!!!";
		}
		function prev()
		{
			if(che<save.length)
				document.getElementById("disp").innerText = save[che++];
			else
				document.getElementById("disp").innerText = "No More OLD Calculations";
			vis();
		}
		function next()
		{
			if(che>0 && che<=save.length)
				document.getElementById("disp").innerText = save[--che];
			else
				document.getElementById("disp").innerText = "No More NEW Calculations";
			vis();
		}
		function rest()
		{
			document.getElementById("disp").innerText = "";
			str="";
			console.log(str);
			vis();
		}
		function getstr(btn)
		{
			che=1;
			if(arr[arr.length-2] == "=")
			{
				rest();
				arr=[];
			}
			let a=btn.innerText;
			if(a == "=")
			{
				str+=" = ";
				calc();
			}
			else if(a == "Bitwise NOT")
			{
				str+=" ~ = ";
				calc();
			}
			else if(a == "Logical NOT")
			{
				str+=" ! = ";
				calc();
			}
			else
			{
				var b="";
				if(a == "Bitwise AND")
					b=" & ";
				else if(a == "Bitwise OR")
					b=" | ";
				else if(a == "Bitwise XOR")
					b=" ^ ";
				else if(a == "Bitwise Right Shift")
					b=" >> ";
				else if(a == "Bitwise Left Shift")
					b=" << ";
				else if(a == "Logical AND")
					b=" && ";
				else if(a == "Logical OR")
					b=" || ";
				if(b.length==0)
					b=a;
				else
					document.querySelectorAll(".i").forEach(e=>e.style.visibility = "hidden");
				str+=b;
				document.getElementById("disp").innerText = str;
			}
		}
		function or(a, b)
		{
			if(a == "1" || b == "1")
				return "1";
			else
				return "0";
		}
		function and(a, b)
		{
			if(a == "1" && b == "1")
				return "1";
			else
				return "0";
		}
		function not(a)
		{
			if(a == "1")
				return "0";
			else
				return "1";
		}
		function rs(a, b)
		{
			if(b>0)
				a=a.slice(0, a.length-(b+1));
			if(a.length==0)
				return "0";
			return a;
		}
		function ls(a, b)
		{
			for(;b!=0;b--)
				a+="0";
			return a;
		}
		function ok(a, b)
		{
			let xx=""; let diff=b.length-a.length;
			for(;diff!=0;diff--)
				xx+="0";
			xx+=a;
			return xx;
		}
		function dec(a)
		{
			let aa=0, c=0;
			for(let i = a.length-1; i>=0; i--)
				aa+=parseInt(a[i])*(2**(c++));
			return aa;
		}
		function calc()
		{
			arr=str.split(" ");
			console.log(arr);
			var zz = "";
			if(arr[1] == "||")
				if(parseInt(arr[0])>0 || parseInt(arr[2])>0)
					zz+="1";
				else
					zz+="0";
			else if(arr[1] == "&&")
				if(parseInt(arr[0])>0 && parseInt(arr[2])>0)
					zz+="1";
				else
					zz+="0";
			else if(arr[1] == "~")
				for(let i=0; i<arr[0].length; i++)
					zz+=not(arr[0][i]);
			else if(arr[1] == "")
				if(parseInt(arr[0])>0)
					zz+="0";
				else
					zz+="1";
			else if(arr[1] == "<<")
				zz+=ls(arr[0], parseInt(arr[2]));
			else if(arr[1] == ">>")
				zz+=rs(arr[0], parseInt(arr[2]));
			else if(arr[1] == "!")
				if(aa[0]>0)
					zz+="0";
				else
					zz+="1";
			else
			{
				if(arr[0].length<arr[2].length)
					arr[0]=ok(arr[0], arr[2]);
				else if(arr[0].length>arr[2].length)
					arr[2]=ok(arr[2], arr[0]);
				if(arr[1] == "|")
					for(let i=0; i<arr[0].length; i++)
						zz+=or(arr[0][i],arr[2][i]);
				else if(arr[1] == "&")
					for(let i=0; i<arr[0].length; i++)
						zz+=and(arr[0][i],arr[2][i]);
				else if(arr[1] == "^")
					for(let i=0; i<arr[0].length; i++)
						zz+=xor(arr[0][i],arr[2][i]);
			}
			str+=zz;
			if (document.querySelector('input[name="n"]:checked').value=="both")
				str+= " (Decimal: " + dec(zz).toString() + ")";
			save.unshift(str);
			document.getElementById("disp").innerText = str;
			vis();
		}
	</script>
</body>
